# 잘못된 equals() 구현
자바에서 `euqals()` 메서드를 직접 구현하는 것은 에러를 초래하는 지름길이다.
모든 필드를 비교하는 작업은 그다지 어렵지 않지만 반복적인 코드 패턴을 작성하다 보면 실수하기 쉽다.

```java
class MyEntity {
    private String name;
    private List<String> attributes;
    private Object data;
    private long timeStamp;
    
    public boolean equals(Object o) {
        if (this == 0) {
            return true;
        }
        
        if (o == null || getClass() != o.getClass()) {
            return false;
        }
        
        MyEntity other = (MyEntity) o;
        return timeStamp == other.timeStamp
                && name.equals(other.name)
                && attributes.equals(attributes) // 자기 자신의 필드와 비교
                && data.equals(other.data);
    }
}
```

일반적으로 IDE는 `equals()` 메서드 구현 코드를 자동으로 생성한다.
그러나 나중에 새로 추가한 필드에 대한 비교를 직접 작성하면 이러한 실수를 저지르기 쉽다.

```java
import java.util.Objects;

class User {
    private String firstName;
    private String middleName;
    private String lastName;
    private Gender gender;
    private int age;

    public boolean equals(Object o) {
        if (this == 0) {
            return true;
        }

        if (o == null || getClass() != o.getClass()) {
            return false;
        }

        User user = (User) o;

        return Objects.equals(firstName, user.firstName)
                && Objects.equals(middleName, user.firstName)
                && Objects.equals(lastName, user.lastName)
                && gender == user.gender
                && age == user.age;
    }
}
```
`middleName`과 `user.firstName`이 비교되고 있다는 사실은 단번에 알아차리기 어렵다.

`equals()` 메서드에서 가장 흔하게 발생하는 문제는 필드가 누락되는 것이다.
새로운 필드를 객체에 추가한 다음 `equals()` 메서드를 고치지 않고 그대로 두는 경우가 많다.

> 실수 방지 가이드
* 가급적이면 `equals()`와 `hashCode()` 메서드를 직접 구현하지 말고 IDE를 이용해 생성한다.
필드를 새로 추가할 때도 마찬가지다. 기존 구현을 손수 고치려다가 에러를 추가하게 될 위험이 있다.
아예 기존 `equals()`와 `hashCode()`를 제거하고 처음부터 다시 생성하는 편이 더 안전하다.
* 자바 16부터 레코드 클래스에 데이터를 저장할 수 있다. 이 클래스는 `equals()`와 `hashCode()`를 컴파일러가 자동으로 생성한다. 가능하면 레코드를 사용하라.
* `null` 가능 필드의 동등성을 검사할 때는 `null`을 직접 다루지 말고 `Objects.equals()` 정적 메서드를 사용하라.
* `euqals()` 메서드를 구현하고 테스트 할 때는 `EqualsVerifier` 등의 전문 라이브러리를 사용한다. `equals()`의 다양한 오작동을 수작업으로 일일이 테스트하기는 어렵다.
`EqualsVerifier` 라이브러리는 `equals()` 메서드를 최대한 완벽히 테스트하기 위해 존재한다.