# 테스트 메서드 조기 종료
유닛 테스트 메서드 본문은 대체로 복잡한 제어 흐름 없이 연이어 명령문을 실행한다.
그러나 일부 개발자는 가끔 이곳에 제어 흐름을 추가하고 조건문이나 예외를 통해 return 문을 실행하며 테스트를 끝내곤 한다.
이러한 테스트 메서드는 잘 읽기도, 이해하기도 어렵다.
또한 누군가 테스트 메서드 마지막 단계에 어설션을 추가해도 중간에 return 문이 있으면 끝까지 도달할 수 없다.
이렇듯 도달하지 못하는 구문이 프로덕션 코드에 있다면 테스트를 만들어 감지할 수 있겠지만, 테스트 코드 자체에 이런 문제가 있으면 어찌할 도리가 없다.

```java
public void testMapping() throws Exception {
    E e = new E();
    e.mymap.put("a.b", "a");
    e.mymap.put("c.e.g", "b");
    
    try {
        getDs().save(e);
    } catch (Exception e) {
        return;
    }
    
    Assert.assertFalse("Should have got rejection...", true);
    e = getDs().get(e);
    Assert.assertEquals("a", e.mymap("a.b"));
    Assert.assertEquals("b", e.mymap("c.e.g"));
}
```
이 테스트의 목적은 두 가지다. 첫 번째 `save()` 메서드가 예외를 던지는지 확인하고, 둘째 `get()` 메서드가 값을 잘 읽는지 확인한다.
그러나 `save()` 메서드가 계획대로 예외를 던지면 테스트는 `catch` 블록 안에서 즉시 끝난다.
그 결과, 메서드 맨 끝에 있는 두 `assertEquals()` 검사는 실행되지 않는다.

> 실수 방지 가이드
* 유닛 테스트 메서드 중간에 결과를 반환하지 않는다. 이러한 반환문은 혼동을 유발하며 일부 어설션을 누락시킨다.
다음과 같이 `assertThrows()`를 쓰면 조기 반환 없이 원하는 바를 정확히 달성할 수 있다.

```java
public void testMapping() {
    E e = new E();
    e.mymap.put("a.b", "a");
    e.mymap.put("c.e.g", "b");
    
    assertThrows(Exception.class, () -> getDs().save(e));
    E restoredE = getDs().get(e);
    Assert.assertEquals("a", restoredE.mymap("a.b"));
    Assert.assertEquals("b", restoredE.mymap("c.e.g"));
}
```
* 하나의 유닛 테스트로 여러 기능을 테스트 하지 않는다. 어설션을 추가하려면 새로운 유닛 테스트를 만들어야 한다.